<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <title>MediSync-Trusted Inventory Partner</title>
    <link rel="stylesheet" href="/static/css/global.css" />
    <link rel="stylesheet" href="/static/css/dashboard-landing-page.css" />
    <link rel="stylesheet" href="/static/css/purchaseorder.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM Sans:wght@400;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito Sans:wght@900&display=swap" />
</head>

<body>
    <div class="dashboard-landing-page">
        <div class="main-container">
            <input class="configuration-group1" placeholder="LOGO" type="text" />

            <div class="inventory-frame">
                <div class="side-nav-bg35"></div>
                <div class="medicine-frame">
                    <div class="warning-frame">
                        <div class="payment-frames">
                            <img class="health-and-safety-black-d-p" loading="eager" alt=""
                                src="/static/public/ellipse-16@2x.png" />

                            <div class="payments-black-d-p"></div>
                        </div>
                        <div class="medical-services-black-d-p">
                            <div class="warning-amber-black-d-p">
                                <div class="selvi8">Tirth</div>
                                <div class="selvi9">Tirth</div>
                            </div>
                            <div class="inventory-status-frame">
                                <div class="super-admin8"> Admin</div>
                                <div class="super-admin9"></div>
                            </div>
                        </div>
                    </div>
                    <div class="visit-inventory-button">
                        <!-- <img class="visit-inventory-button-child" alt="" src="/static/public/group-13.svg" />

                        <img class="visit-inventory-button-item" loading="eager" alt=""
                            src="/static/public/group-13.svg" /> -->
                    </div>
                </div>
                <form class="group14">
                    <div class="my-pharmacy1">
                        <div class="rectangle-parent179"> <!-- color change karo -->
                            <div class="frame-child227"></div>
                            <img class="total-suppliers-icon" alt="" src="/static/public/vector-2.svg" />

                            <div class="dashboard15">
                                <a href="/dashboard" style="color: white;"> Dashboard </a>
                            </div>
                        </div>
                        <div class="customers6">
                            <div class="rectangle-parent180">
                                <div class="frame-child228"></div>
                                <div class="frequently-bought">
                                    <img class="group-icon31" alt="" src="/static/public/group.svg" />

                                    <div class="inventory23">
                                        <a href="/inventoryhome" style="color: white;"> Inventory Details</a> </div>
                                </div>
                                <!-- <img
                    class="inventory-frame-icon"
                    alt=""
                    src="/static/public/vector-4.svg"
                  /> -->
                            </div>
                            <div class="rectangle-parent181">
                                <div class="frame-child229"></div>
                                <div class="group-parent10">
                                    <img class="group-icon32" alt="" src="/static/public/group-1.svg" />

                                    <div class="reports17">
                                        <a href="/report" style="color: white;">Generate Report</a>
                                    </div>
                                </div>
                                <!-- <img
                      class="vector-icon98"
                      alt=""
                      src="/static/public/vector-4.svg"
                    /> -->
                            </div>
                            <div class="rectangle-parent182">
                                <div class="frame-child230"></div>
                                <img class="vector-icon99" alt="" src="/static/public/vector-5.svg" />

                                <div class="configuration14"><a href="/InventoryDetails" style="color: white;"> 
                                    Medicine Details</a>
                                </div>
                            </div>
                            <div class="rectangle-parent182">
                                <div class="frame-child230"></div>
                                <img class="vector-icon99" alt="" src="/static/public/group-1.svg" />

                                <div class="configuration14">
                                    <a href="/stocktrack" style="color: white;">Stock Tracking</a>
                                 </div>
                            </div>
                        </div>
                    </div>
                    <div class="quick-report-frame"></div>
                    <div class="quick-report-frame1">
                        <div class="rectangle-parent183">
                            <div class="frame-child231"></div>
                            <img class="group-icon33" alt="" src="/static/public/vector-6.svg" />

                            <div class="inventory-list4">
                                <div class="contact-management16">
                                    <a href="/customer" style="color: white;">Customer Information</a>
                                </div>
                            </div>
                            <!-- <img
                  class="frame-header-icon"
                  alt=""
                  src="/static/public/vector-4.svg"
                /> -->
                        </div>
                        <div class="rectangle-parent184">
                            <div class="frame-child232"></div>
                            <div class="line-separator7">
                                <img class="quick-report-icon" loading="eager" alt=""
                                    src="/static/public/vector-8.svg" />

                                <div class="notifications14">
                                    <a href="/employee" style="color: white;">     Employee Information</a>
                                </div>
                            </div>
                            <!-- <div class="group-by-groups">
                  <div class="frame-actions"></div>
                  <div class="go-to-configuration1">01</div>
                </div> -->
                        </div>
                        <div class="rectangle-parent185">
                            <div class="frame-child233"></div>
                            <img class="revenue-qty-icon" alt="" src="/static/public/vector-9.svg" />

                            <input class="chat-with-visitors13" placeholder="Chat with Visitors" type="text" />
                        </div>
                    </div>
                    <div class="you-have-completed-the-add-use"></div>
                    <div class="quick-report-frame2">
                        <button class="rectangle-parent186">
                            <div class="frame-child234"></div>
                            <img class="vector-icon100" alt="" src="/static/public/vector-10.svg" />

                            <div class="application-settings14">Application Settings</div>
                        </button>
                        <!-- <div class="rectangle-parent187">
                <div class="frame-child235"></div> -->
                        <!-- <img
                  class="vector-icon101"
                  alt=""
                  src="/static/public/vector-11.svg"
                /> -->

                        <!-- <input class="covid-1911" placeholder="Covid -19" type="text" /> -->
                        <!-- </div> -->
                        <div class="rectangle-parent188">
                            <div class="frame-child236"></div>
                            <img class="vector-icon102" loading="eager" alt="" src="/static/public/vector-12.svg" />

                            <div class="get-technical-help10">Get Technical Help</div>
                        </div>
                        <button class="rectangle-parent186">
                            <div class="frame-child234"></div>
                            <img class="vector-icon100" alt="" src="/static/public/vector-10.svg" />

                            <div class="application-settings14">Log Out</div>
                        </button>
                    </div>
                </form>
                <div class="inventory-frame-inner">
                    <div class="frame-child237"></div>
                </div>
            </div>
        </div>
        <img class="dashboard-landing-page-child" alt="" src="/static/public/ellipse-16@2x.png" />

        <main class="january-frame">
            <div class="line-frame3">
                <div class="side-nav-bg36"></div>
                <div class="quick-report-frame3">
                    <div class="top-bar-bg-parent18">
                        <div class="top-bar-bg29"></div>
                        <input class="search-for-anything13" placeholder="Search for anything here.." type="text" />

                        <img class="inventory-group-frame" alt="" src="/static/public/azithral-tablet.svg" />
                    </div>
                    <div class="total-no-of-medicines-frame">
                        <div class="medicine-groups-frame1">
                            <img class="translate-black-24dp-1-icon13" alt=""
                                src="/static/public/translate-black-24dp-1.svg" />

                            <div class="english-us13">English (US)</div>
                            <img class="revenue-frame-icon" alt="" src="/static/public/vector-1.svg" />
                        </div>
                        <div class="totalnoof-suppliers-frame">
                            <div class="totalnoof-users-frame">
                                <div class="customers-frame4"></div>
                                <div class="good-morning14">Good Morning</div>
                            </div>
                            <div class="february-2024-group">
                                <div class="february-20242">16 March, 2024</div>
                                <div class="group15">
                                    <div class="configuration-frame"></div>
                                    <div class="div29">22:45:04</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="warning-frame1"></div>
            </div>
            <!--  -->
            <!--  -->
            <!--  -->
            <!--  -->
            <!--  -->
            <div class="main" style="margin-left: -40%;"><b>
                    <k style="color: darkgray;font-size: 23px;">&nbsp;<b>Inventory Details</b>&nbsp; </k>
                    <h style="font-size: 20px;"><b>>&nbsp;</b></h>
                    <k style="color:black;font-size: 25px;"><b>Generate Purchase Order</b></k>
                    <!-- <button type="submit" style="background-color: red;">Submit</button>
                <button type="reset" style="background-color: red;" onclick="resetForm()">Reset</button> -->
            </div>
            <!-- 
            //////////////////////////////////////
            //////////////////////////////////////
        -->
            <div class="container">
                <!-- <h2>Purchase Order Form</h2> -->
                <form action="/purchaseorder" id="purchaseOrderForm" class="form" method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <div class="form-row">
                        <div class="form-column">
                            <label for="orderId">Order ID:</label>
                            <input type="text" id="orderId" name="orderId" required>
                        </div>
                        <div class="form-column">
                            <label for="orderDate">Order Date:</label>
                            <input type="date" id="orderDate" name="orderDate" required min="2024-04-19"
                                max="2024-04-30">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-column">
                            <label for="totalCost">Total Cost:</label>
                            <input type="number" id="totalCost" name="totalCost" required min="10">
                        </div>
                        <div class="form-column">
                            <label for="unitPrice">Unit Price:</label>
                            <input type="number" id="unitPrice" name="unitPrice" required min="5">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-column">
                            <label for="medicineId">Medicine ID:</label>
                            <input type="text" id="medicineId" name="medicineId" required min="5">
                        </div>
                        <div class="form-column">
                            <label for="supplierId">Supplier ID:</label>
                            <input type="text" id="supplierId" name="supplierId" required min="5">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-column">
                            <label for="quantityOrdered">Quantity Ordered:</label>
                            <input type="number" id="quantityOrdered" name="quantityOrdered" required min="2">
                        </div>
                        <div class="form-column">
                            <label for="transactionId">Transaction ID:</label>
                            <input type="text" id="transactionId" name="transactionId" required min="5">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-column">
                            <label for="transactionType">Transaction Type:</label>
                            <select id="transactionType" name="transactionType" required style="width: 97.5%;">
                                <option value="">Select Transaction Type</option>
                                <option value="Cash">Cash</option>
                                <option value="Credit Card">Debit Card</option>
                                <option value="Debit Card">Credit Card</option>
                                <option value="UPI">UPI / Google Pay</option>
                            </select>
                        </div>
                        <div class="form-column" style="width: 90%;">
                            <label for="invoiceDate">Invoice Date:</label>
                            <input type="date" id="invoiceDate" name="invoiceDate" required min="2024-04-25"
                                max="2024-04-27">
                        </div>
                    </div>
                    <div class="form-row" style="width: 105.5%;">
                        <div class="form-column">
                            <label for="email">Supplier Email:</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <button type="submit" class="b1" style="margin-left: 27%;background-color: red;">Submit</button>
                        <button type="button" class="b1" class="reset" onclick="resetForm()"
                            style="margin-left: 5%;background-color: red; ">Reset</button>
                    </div>
                </form>
            </div>
            <!--  -->
        </main>
    </div>
    <!-- 
    //////////////////////////////////////
    //////////////////////////////////////
 -->
    <!-- 
    //////////////////////////////////////
    //////////////////////////////////////
 -->

    </div>
    </div>
    </section>
    </main>
    </div>
    <script>
        function resetForm() {
            document.getElementById("purchaseOrderForm").reset();
        }
        document.getElementById('invoiceDate').addEventListener('change', function () {
            var endDateValue = this.value;
            if (!isValidDate(endDateValue)) {
                alert('Invalid date selected. Please select a date on or before today.');
                this.value = ''; // Clear the input value
            }
        });

        document.getElementById("purchaseOrderForm").addEventListener("submit", function (event) {
            const form = document.getElementById("purchaseOrderForm");
            if (!form.checkValidity()) {
                event.preventDefault(); // Prevent form submission if not valid
                alert("Please fill in all required fields.");
                return;
            }

            // Advanced validations
            const totalCost = parseFloat(document.getElementById("totalCost").value);
            const unitPrice = parseFloat(document.getElementById("unitPrice").value);
            const quantityOrdered = parseInt(document.getElementById("quantityOrdered").value);
            const transactionId = document.getElementById("transactionId").value;
            const invoiceDate = new Date(document.getElementById("invoiceDate").value);
            const orderDate = new Date(document.getElementById("orderDate").value);
            const transactionType = document.getElementById("transactionType").value;
            const email = document.getElementById("email").value;
            const orderId = document.getElementById("orderId").value;

            // Validate total cost decimal places (no more than two)
            if (!(/^\d+(\.\d{1,2})?$/.test(totalCost))) {
                event.preventDefault();
                alert("Total cost must have no more than two decimal places.");
                return;
            }

            // Validate unit price decimal places (no more than two)
            if (!(/^\d+(\.\d{1,2})?$/.test(unitPrice))) {
                event.preventDefault();
                alert("Unit price must have no more than two decimal places.");
                return;
            }

            //Ensure that the total cost is not less than the unit price multiplied by the quantity ordered.
            if (totalCost < unitPrice * quantityOrdered) {
                event.preventDefault();
                alert("Total cost must be greater than or equal to the unit price multiplied by the quantity ordered.");
                return;
            }

            // Ensure that the invoice date is not before the order date.
            if (invoiceDate < orderDate) {
                event.preventDefault();
                alert("Invoice date cannot be before the order date.");
                return;
            }

            //Limit the quantity ordered to a maximum of 1000 units.
            if (quantityOrdered > 1000) {
                event.preventDefault();
                alert("Quantity ordered cannot exceed 1000 units.");
                return;
            }

            //Validate that the transaction type consists only of letters and spaces.
            if (!/^[a-zA-Z\s]+$/.test(transactionType)) {
                event.preventDefault();
                alert("Transaction type can only contain letters and spaces.");
                return;
            }

            // Simulate checking Transaction ID uniqueness (replace this with actual logic)
            //Ensure that the Transaction ID is unique and not already used in the system.
            // For demonstration purposes, we're assuming it's unique if it's not empty
            if (!transactionId) {
                event.preventDefault();
                alert("Transaction ID must be unique.");
                return;
            }

            // Validate Order Date within the last 30 days
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            if (orderDate < thirtyDaysAgo) {
                event.preventDefault();
                alert("Order date must be within the last 30 days.");
                return;
            }

            // Validate Invoice Date not in the future
            const today = new Date();
            if (invoiceDate > today) {
                event.preventDefault();
                alert("Invoice date cannot be in the future.");
                return;
            }

            // Validate Transaction ID format (e.g., "TRX" followed by 5 digits)
            if (!/^TRX\d{5}$/.test(transactionId)) {
                event.preventDefault();
                alert("Transaction ID must start with 'TRX' followed by 5 digits.");
                return;
            }

            // Validate total cost minimum value ($10)
            if (totalCost < 10) {
                event.preventDefault();
                alert("Total cost must be greater than or equal to $10.");
                return;
            }

            // Validate unit price minimum value ($0.01)
            if (unitPrice < 0.01) {
                event.preventDefault();
                alert("Unit price must be greater than or equal to $0.01.");
                return;
            }

            // Validate order date is not a weekend (Saturday or Sunday)
            if (orderDate.getDay() === 0 || orderDate.getDay() === 6) {
                event.preventDefault();
                alert("Order date cannot be a weekend (Saturday or Sunday).");
                return;
            }

            // Validate email format using regex
            if (!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(email)) {
                event.preventDefault();
                alert("Please enter a valid email address.");
                return;
            }

            // Validate order ID format (e.g., "ORD" followed by 5 digits)
            if (!/^ORD\d{5}$/.test(orderId)) {
                event.preventDefault();
                alert("Order ID must start with 'ORD' followed by 5 digits.");
                return;
            }

            alert("Purchase order generated successfully! \nTeam MediSYnc");
        });
        //////////////////////////////////
        //////////////////////////////////
        //////////////////////////////////

        // Function to validate Order Date
        function validateOrderDate() {
            var orderDate = document.getElementById('orderDate').value;
            var currentDate = new Date().toISOString().slice(0, 10); // Get current date in YYYY-MM-DD format

            if (orderDate < currentDate) {
                alert("Order Date cannot be in the past.");
                return false;
            }

            var invoiceDate = document.getElementById('invoiceDate').value;
            if (orderDate > invoiceDate) {
                alert("Order Date cannot be after the Invoice Date.");
                return false;
            }

            return true; // Validation successful
        }

        // Function to update the Invoice Date to current date and disable the field
        function updateInvoiceDate() {
            var invoiceDateField = document.getElementById('invoiceDate');
            var currentDate = new Date().toISOString().slice(0, 10); // Get current date in YYYY-MM-DD format
            invoiceDateField.value = currentDate;
            invoiceDateField.disabled = true;
        }

        // Add event listener to form submission
        document.getElementById('purchaseOrderForm').addEventListener('submit', function (event) {
            if (!validateOrderDate()) {
                event.preventDefault(); // Prevent form submission if validation fails
            }
        });

        // Call updateInvoiceDate function when the page loads
        window.onload = function () {
            updateInvoiceDate();
        };


        //////////////////////////////////
        //////////////////////////////////
        function validateOrderDate() {
            var orderDate = document.getElementById('orderDate').value;
            var currentDate = new Date().toISOString().slice(0, 10); // Get current date in YYYY-MM-DD format

            if (orderDate < currentDate) {
                alert("Order Date cannot be in the past.");
                return false;
            }

            var invoiceDate = document.getElementById('invoiceDate').value;
            if (orderDate > invoiceDate) {
                alert("Order Date cannot be after the Invoice Date.");
                return false;
            }

            return true; // Validation successful
        }

        document.getElementById('purchaseOrderForm').addEventListener('submit', function (event) {
            if (!validateOrderDate()) {
                event.preventDefault(); // Prevent form submission if validation fails
            }
        });
        //////////////////////////////////
        //////////////////////////////////
        // Function to generate a random alphanumeric string for order ID
        function generateOrderId() {
            var prefix = 'ORD_'; // Prefix for the order ID
            var suffix = Math.random().toString(36).substr(2, 4).toUpperCase(); // Random alphanumeric suffix
            var numbers = Math.floor(Math.random() * 900) + 100; // Random 3-digit number
            var finalId = prefix + suffix + numbers; // Concatenate prefix, suffix, and numbers
            return finalId;
        }

        // Set the generated order ID and disable the field
        document.addEventListener('DOMContentLoaded', function () {
            var orderIdField = document.getElementById('orderId');
            var generatedOrderId = generateOrderId();
            orderIdField.value = generatedOrderId;
            orderIdField.disabled = true;
        });


    </script>
</body>

</html>